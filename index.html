<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Royal Republic FC</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #0e0e0e;
      color: #fff;
      margin: 0;
      padding: 0;
    }
    header {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 20px;
      background-color: #1a1a1a;
    }
    header img {
      width: 50px;
      height: 50px;
    }
    header h1 {
      margin: 0;
      font-size: 24px;
    }
    .container {
      padding: 20px;
      max-width: 1000px;
      margin: auto;
    }
    .card {
      background: #1f1f1f;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 8px;
      box-shadow: 0 0 8px #00000080;
    }
    .card h3 {
      margin: 0 0 10px;
    }
    .goals-assists span {
      font-weight: bold;
      color: #00eaff;
    }
    #match-history {
      margin-top: 30px;
      display: none;
    }
    #match-history h3 {
      margin-bottom: 10px;
    }
    .match {
      background-color: #2a2a2a;
      padding: 10px;
      margin-bottom: 5px;
      border-radius: 6px;
    }
    .awards {
      font-size: 14px;
      color: gold;
      margin-top: 8px;
    }
    button {
      background-color: #00eaff;
      color: black;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <header>
    <img src="logo.png" alt="Club Logo" />
    <h1>Royal Republic FC</h1>
  </header>

  <div class="container">
    <button id="toggleProjection">üîÆ Show Projections</button>
    <div id="players"></div>

    <div id="match-history">
      <h3>üìú Match History</h3>
      <div id="matches"></div>
    </div>
  </div>

  <script>
    const CLUB_ID = 2491998;
    const PLATFORM = 'common-gen5';
    const projectionGames = 500;
    let projectionMode = false;

    async function fetchPlayerStats() {
      const res = await fetch(`https://proclubs.ea.com/api/fc/members/stats?platform=${PLATFORM}&clubId=${CLUB_ID}`);
      const data = await res.json();
      const playersDiv = document.getElementById("players");

      const sorted = Object.values(data).sort((a, b) => b.ratings.averageRating - a.ratings.averageRating);
      const topScorer = sorted.reduce((max, p) => p.stats.goals > max.stats.goals ? p : max, sorted[0]);
      const topAssister = sorted.reduce((max, p) => p.stats.assists > max.stats.assists ? p : max, sorted[0]);
      const playerOfSeason = sorted[0];

      playersDiv.innerHTML = "";
      sorted.forEach(p => {
        const card = document.createElement("div");
        card.className = "card";

        const projGoals = Math.round((p.stats.goals / p.stats.gamesPlayed) * projectionGames);
        const projAssists = Math.round((p.stats.assists / p.stats.gamesPlayed) * projectionGames);

        const awards = [];
        if (p === playerOfSeason) awards.push("üèÜ Player of the Season");
        if (p === topScorer) awards.push("ü•á Golden Boot");
        if (p === topAssister) awards.push("üéØ Playmaker Award");

        card.innerHTML = `
          <h3>${p.name}</h3>
          <p class="goals-assists" data-real-goals="${p.stats.goals}" data-real-assists="${p.stats.assists}">
            Goals: <span>${p.stats.goals}</span> | Assists: <span>${p.stats.assists}</span>
          </p>
          <p class="awards">${awards.join(" | ")}</p>
          <input type="hidden" class="projections" value="${projGoals},${projAssists}" />
        `;

        playersDiv.appendChild(card);
      });
    }

    document.getElementById("toggleProjection").addEventListener("click", () => {
      projectionMode = !projectionMode;
      const button = document.getElementById("toggleProjection");
      const cards = document.querySelectorAll(".card");
      const matchHistoryDiv = document.getElementById("match-history");

      cards.forEach(card => {
        const proj = card.querySelector(".projections").value.split(",");
        const goalsAssistsEl = card.querySelector(".goals-assists");
        if (projectionMode) {
          goalsAssistsEl.innerHTML = `Projected Goals: <span>${proj[0]}</span> | Projected Assists: <span>${proj[1]}</span>`;
        } else {
          const realGoals = goalsAssistsEl.getAttribute("data-real-goals");
          const realAssists = goalsAssistsEl.getAttribute("data-real-assists");
          goalsAssistsEl.innerHTML = `Goals: <span>${realGoals}</span> | Assists: <span>${realAssists}</span>`;
        }
      });

      matchHistoryDiv.style.display = projectionMode ? "block" : "none";
      button.innerText = projectionMode ? "üìä Show Real Stats" : "üîÆ Show Projections";
    });

    async function fetchMatchHistory() {
      const res = await fetch(`https://proclubs.ea.com/api/fc/clubs/matches?matchType=leagueMatch&platform=${PLATFORM}&clubIds=${CLUB_ID}`);
      const data = await res.json();
      const matchesDiv = document.getElementById("matches");

      matchesDiv.innerHTML = "";
      data.reverse().forEach(match => {
        const matchEl = document.createElement("div");
        matchEl.className = "match";
        const date = new Date(match.timestamp);
        matchEl.innerText = `${date.toLocaleDateString()} - ${match.club1.name} ${match.club1.score} : ${match.club2.score} ${match.club2.name}`;
        matchesDiv.appendChild(matchEl);
      });
    }

    fetchPlayerStats();
    fetchMatchHistory();
  </script>
</body>
</html>
